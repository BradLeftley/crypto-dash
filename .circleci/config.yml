    version: 2.1
    orbs:
      aws-s3: circleci/aws-s3@2.0.0
    jobs:
      build:
        docker:
          - image: circleci/node:12.9.1-browsers
    
        working_directory: ~/repo
    
        steps:
          - checkout
    
          - restore_cache:
              keys:
                - v1-dependencies-{{ checksum "package.json" }}
                # fallback to using the latest cache if no exact match is found
                - v1-dependencies-
          - run: yarn install
    
          - save_cache:
              paths:
                - node_modules
                - ~/.npm
                - ~/.cache
              key: v1-dependencies-{{ checksum "package.json" }}
    
          - run: yarn build

      deploy:
        docker:
          - image: 'cimg/python:3.6'
        steps:
         - checkout
         - run: mkdir bucket && echo "lorem ipsum" > bucket/build_asset.txt
         - aws-s3/sync:
            arguments: |
              --acl public-read \
              --cache-control "max-age=86400"
            aws-access-key-id: AWS_ACCESS_KEY_ID_BLUE
            aws-region: AWS_REGION_BLUE
            aws-secret-access-key: AWS_SECRET_ACCESS_KEY_BLUE
            from: bucket
            to: 's3://my-s3-bucket-name/prefix'
         - aws-s3/copy:
            arguments: '--dryrun'
            from: bucket/build_asset.txt
            to: 's3://my-s3-bucket-name'
